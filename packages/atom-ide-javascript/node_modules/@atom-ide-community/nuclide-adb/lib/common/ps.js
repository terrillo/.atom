"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.parsePsTableOutput = parsePsTableOutput;

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */
function parsePsTableOutput(output, desiredFields) {
  const lines = output.split(/\n/);
  const header = lines[0];
  const cols = header.split(/\s+/);
  const colMapping = {};

  for (let i = 0; i < cols.length; i++) {
    const columnName = cols[i].toLowerCase();

    if (desiredFields.includes(columnName)) {
      colMapping[i] = columnName;
    }
  }

  const formattedData = [];
  const data = lines.slice(1);
  const ignoreSColumn = cols.find(col => col.trim() === 'S') == null;
  data.filter(row => row.trim() !== '').forEach(row => {
    const rowData = row.split(/\s+/);
    const rowObj = {};

    for (let i = 0; i < rowData.length; i++) {
      const effectiveColumn = i;

      if (ignoreSColumn) {
        // Android's ps output has an extra column "S" (versions prior to API 26)
        // in the data that doesn't appear in the header. Skip that column's value.
        if (rowData[i] === 'S' && i < rowData.length - 1) {
          i++;
        }
      }

      if (colMapping[effectiveColumn] !== undefined) {
        rowObj[colMapping[effectiveColumn]] = rowData[i];
      }
    }

    formattedData.push(rowObj);
  });
  return formattedData;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL251Y2xpZGUvbnVjbGlkZS1hZGIvbGliL2NvbW1vbi9wcy5qcyJdLCJuYW1lcyI6WyJwYXJzZVBzVGFibGVPdXRwdXQiLCJvdXRwdXQiLCJkZXNpcmVkRmllbGRzIiwibGluZXMiLCJzcGxpdCIsImhlYWRlciIsImNvbHMiLCJjb2xNYXBwaW5nIiwiaSIsImxlbmd0aCIsImNvbHVtbk5hbWUiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiZm9ybWF0dGVkRGF0YSIsImRhdGEiLCJzbGljZSIsImlnbm9yZVNDb2x1bW4iLCJmaW5kIiwiY29sIiwidHJpbSIsImZpbHRlciIsInJvdyIsImZvckVhY2giLCJyb3dEYXRhIiwicm93T2JqIiwiZWZmZWN0aXZlQ29sdW1uIiwidW5kZWZpbmVkIiwicHVzaCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7Ozs7Ozs7OztBQVlPLFNBQVNBLGtCQUFULENBQ0xDLE1BREssRUFFTEMsYUFGSyxFQUdVO0FBQ2YsUUFBTUMsS0FBSyxHQUFHRixNQUFNLENBQUNHLEtBQVAsQ0FBYSxJQUFiLENBQWQ7QUFDQSxRQUFNQyxNQUFNLEdBQUdGLEtBQUssQ0FBQyxDQUFELENBQXBCO0FBQ0EsUUFBTUcsSUFBSSxHQUFHRCxNQUFNLENBQUNELEtBQVAsQ0FBYSxLQUFiLENBQWI7QUFDQSxRQUFNRyxVQUFVLEdBQUcsRUFBbkI7O0FBRUEsT0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHRixJQUFJLENBQUNHLE1BQXpCLEVBQWlDRCxDQUFDLEVBQWxDLEVBQXNDO0FBQ3BDLFVBQU1FLFVBQVUsR0FBR0osSUFBSSxDQUFDRSxDQUFELENBQUosQ0FBUUcsV0FBUixFQUFuQjs7QUFDQSxRQUFJVCxhQUFhLENBQUNVLFFBQWQsQ0FBdUJGLFVBQXZCLENBQUosRUFBd0M7QUFDdENILE1BQUFBLFVBQVUsQ0FBQ0MsQ0FBRCxDQUFWLEdBQWdCRSxVQUFoQjtBQUNEO0FBQ0Y7O0FBRUQsUUFBTUcsYUFBYSxHQUFHLEVBQXRCO0FBQ0EsUUFBTUMsSUFBSSxHQUFHWCxLQUFLLENBQUNZLEtBQU4sQ0FBWSxDQUFaLENBQWI7QUFDQSxRQUFNQyxhQUFhLEdBQUdWLElBQUksQ0FBQ1csSUFBTCxDQUFVQyxHQUFHLElBQUlBLEdBQUcsQ0FBQ0MsSUFBSixPQUFlLEdBQWhDLEtBQXdDLElBQTlEO0FBQ0FMLEVBQUFBLElBQUksQ0FBQ00sTUFBTCxDQUFZQyxHQUFHLElBQUlBLEdBQUcsQ0FBQ0YsSUFBSixPQUFlLEVBQWxDLEVBQXNDRyxPQUF0QyxDQUE4Q0QsR0FBRyxJQUFJO0FBQ25ELFVBQU1FLE9BQU8sR0FBR0YsR0FBRyxDQUFDakIsS0FBSixDQUFVLEtBQVYsQ0FBaEI7QUFDQSxVQUFNb0IsTUFBTSxHQUFHLEVBQWY7O0FBQ0EsU0FBSyxJQUFJaEIsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR2UsT0FBTyxDQUFDZCxNQUE1QixFQUFvQ0QsQ0FBQyxFQUFyQyxFQUF5QztBQUN2QyxZQUFNaUIsZUFBZSxHQUFHakIsQ0FBeEI7O0FBQ0EsVUFBSVEsYUFBSixFQUFtQjtBQUNqQjtBQUNBO0FBQ0EsWUFBSU8sT0FBTyxDQUFDZixDQUFELENBQVAsS0FBZSxHQUFmLElBQXNCQSxDQUFDLEdBQUdlLE9BQU8sQ0FBQ2QsTUFBUixHQUFpQixDQUEvQyxFQUFrRDtBQUNoREQsVUFBQUEsQ0FBQztBQUNGO0FBQ0Y7O0FBRUQsVUFBSUQsVUFBVSxDQUFDa0IsZUFBRCxDQUFWLEtBQWdDQyxTQUFwQyxFQUErQztBQUM3Q0YsUUFBQUEsTUFBTSxDQUFDakIsVUFBVSxDQUFDa0IsZUFBRCxDQUFYLENBQU4sR0FBc0NGLE9BQU8sQ0FBQ2YsQ0FBRCxDQUE3QztBQUNEO0FBQ0Y7O0FBRURLLElBQUFBLGFBQWEsQ0FBQ2MsSUFBZCxDQUFtQkgsTUFBbkI7QUFDRCxHQW5CRDtBQXFCQSxTQUFPWCxhQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXHJcbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxyXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcclxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXHJcbiAqXHJcbiAqIEBmbG93XHJcbiAqIEBmb3JtYXRcclxuICovXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VQc1RhYmxlT3V0cHV0KFxyXG4gIG91dHB1dDogc3RyaW5nLFxyXG4gIGRlc2lyZWRGaWVsZHM6IEFycmF5PHN0cmluZz4sXHJcbik6IEFycmF5PE9iamVjdD4ge1xyXG4gIGNvbnN0IGxpbmVzID0gb3V0cHV0LnNwbGl0KC9cXG4vKTtcclxuICBjb25zdCBoZWFkZXIgPSBsaW5lc1swXTtcclxuICBjb25zdCBjb2xzID0gaGVhZGVyLnNwbGl0KC9cXHMrLyk7XHJcbiAgY29uc3QgY29sTWFwcGluZyA9IHt9O1xyXG5cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHtcclxuICAgIGNvbnN0IGNvbHVtbk5hbWUgPSBjb2xzW2ldLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBpZiAoZGVzaXJlZEZpZWxkcy5pbmNsdWRlcyhjb2x1bW5OYW1lKSkge1xyXG4gICAgICBjb2xNYXBwaW5nW2ldID0gY29sdW1uTmFtZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbnN0IGZvcm1hdHRlZERhdGEgPSBbXTtcclxuICBjb25zdCBkYXRhID0gbGluZXMuc2xpY2UoMSk7XHJcbiAgY29uc3QgaWdub3JlU0NvbHVtbiA9IGNvbHMuZmluZChjb2wgPT4gY29sLnRyaW0oKSA9PT0gJ1MnKSA9PSBudWxsO1xyXG4gIGRhdGEuZmlsdGVyKHJvdyA9PiByb3cudHJpbSgpICE9PSAnJykuZm9yRWFjaChyb3cgPT4ge1xyXG4gICAgY29uc3Qgcm93RGF0YSA9IHJvdy5zcGxpdCgvXFxzKy8pO1xyXG4gICAgY29uc3Qgcm93T2JqID0ge307XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJvd0RhdGEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgZWZmZWN0aXZlQ29sdW1uID0gaTtcclxuICAgICAgaWYgKGlnbm9yZVNDb2x1bW4pIHtcclxuICAgICAgICAvLyBBbmRyb2lkJ3MgcHMgb3V0cHV0IGhhcyBhbiBleHRyYSBjb2x1bW4gXCJTXCIgKHZlcnNpb25zIHByaW9yIHRvIEFQSSAyNilcclxuICAgICAgICAvLyBpbiB0aGUgZGF0YSB0aGF0IGRvZXNuJ3QgYXBwZWFyIGluIHRoZSBoZWFkZXIuIFNraXAgdGhhdCBjb2x1bW4ncyB2YWx1ZS5cclxuICAgICAgICBpZiAocm93RGF0YVtpXSA9PT0gJ1MnICYmIGkgPCByb3dEYXRhLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChjb2xNYXBwaW5nW2VmZmVjdGl2ZUNvbHVtbl0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJvd09ialtjb2xNYXBwaW5nW2VmZmVjdGl2ZUNvbHVtbl1dID0gcm93RGF0YVtpXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZvcm1hdHRlZERhdGEucHVzaChyb3dPYmopO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gZm9ybWF0dGVkRGF0YTtcclxufVxyXG4iXX0=