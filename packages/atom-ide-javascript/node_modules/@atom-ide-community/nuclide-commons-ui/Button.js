"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Button = exports.ButtonTypes = exports.ButtonSizes = void 0;

var _classnames = _interopRequireDefault(require("classnames"));

var React = _interopRequireWildcard(require("react"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _string = require("@atom-ide-community/nuclide-commons/string");

var _lodash = require("lodash");

var _addTooltip = _interopRequireDefault(require("./addTooltip"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

const ButtonSizes = Object.freeze({
  EXTRA_SMALL: 'EXTRA_SMALL',
  SMALL: 'SMALL',
  LARGE: 'LARGE'
});
exports.ButtonSizes = ButtonSizes;
const ButtonTypes = Object.freeze({
  PRIMARY: 'PRIMARY',
  INFO: 'INFO',
  SUCCESS: 'SUCCESS',
  WARNING: 'WARNING',
  ERROR: 'ERROR'
});
exports.ButtonTypes = ButtonTypes;
const ButtonSizeClassnames = Object.freeze({
  EXTRA_SMALL: 'btn-xs',
  SMALL: 'btn-sm',
  LARGE: 'btn-lg'
});
const ButtonTypeClassnames = Object.freeze({
  PRIMARY: 'btn-primary',
  INFO: 'btn-info',
  SUCCESS: 'btn-success',
  WARNING: 'btn-warning',
  ERROR: 'btn-error'
});
/**
 * Generic Button wrapper.
 */

class Button extends React.Component {
  constructor(...args) {
    super(...args);
    this._button = void 0;
    this._removeTooltip = void 0;

    this._onRefChange = button => {
      const {
        disabled,
        onButtonDOMNodeChange,
        tooltip
      } = this.props;
      this._button = button;

      if (onButtonDOMNodeChange) {
        onButtonDOMNodeChange(this._button);
      } // When the element goes away (e.g. on unmount), remove the tooltip.


      if (button == null && this._removeTooltip != null) {
        this._removeTooltip();
      }

      if (!disabled && tooltip && button != null) {
        const updateTooltip = (0, _addTooltip.default)(tooltip);
        updateTooltip(button);

        this._removeTooltip = () => {
          updateTooltip(null);
          this._removeTooltip = null;
        };
      }
    };
  }

  focus() {
    const node = _reactDom.default.findDOMNode(this);

    if (node == null) {
      return;
    } // $FlowFixMe


    node.focus();
  }

  render() {
    const {
      disabled,
      icon,
      buttonType,
      selected,
      size,
      children,
      className,
      wrapperElement,
      tooltip,
      ...remainingProps
    } = this.props;
    const buttonProps = (0, _lodash.omit)(remainingProps, 'onButtonDOMNodeChange');
    const sizeClassname = size == null ? '' : ButtonSizeClassnames[size] || '';
    const buttonTypeClassname = buttonType == null ? '' : ButtonTypeClassnames[buttonType] || '';
    const titleToolTip = tooltip && disabled ? tooltip.title : null;
    const newClassName = (0, _classnames.default)(className, 'btn', {
      [`icon icon-${(0, _string.maybeToString)(icon)}`]: icon != null,
      [sizeClassname]: size != null,
      selected,
      [buttonTypeClassname]: buttonType != null
    });
    const Wrapper = wrapperElement == null ? 'button' : wrapperElement;
    return /*#__PURE__*/React.createElement(Wrapper, _extends({
      className: newClassName // eslint-disable-next-line nuclide-internal/jsx-simple-callback-refs
      ,
      ref: this._onRefChange,
      disabled: disabled
    }, buttonProps, {
      title: titleToolTip
    }), children);
  }

}

exports.Button = Button;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL0J1dHRvbi5qcyJdLCJuYW1lcyI6WyJCdXR0b25TaXplcyIsIk9iamVjdCIsImZyZWV6ZSIsIkVYVFJBX1NNQUxMIiwiU01BTEwiLCJMQVJHRSIsIkJ1dHRvblR5cGVzIiwiUFJJTUFSWSIsIklORk8iLCJTVUNDRVNTIiwiV0FSTklORyIsIkVSUk9SIiwiQnV0dG9uU2l6ZUNsYXNzbmFtZXMiLCJCdXR0b25UeXBlQ2xhc3NuYW1lcyIsIkJ1dHRvbiIsIlJlYWN0IiwiQ29tcG9uZW50IiwiX2J1dHRvbiIsIl9yZW1vdmVUb29sdGlwIiwiX29uUmVmQ2hhbmdlIiwiYnV0dG9uIiwiZGlzYWJsZWQiLCJvbkJ1dHRvbkRPTU5vZGVDaGFuZ2UiLCJ0b29sdGlwIiwicHJvcHMiLCJ1cGRhdGVUb29sdGlwIiwiZm9jdXMiLCJub2RlIiwiUmVhY3RET00iLCJmaW5kRE9NTm9kZSIsInJlbmRlciIsImljb24iLCJidXR0b25UeXBlIiwic2VsZWN0ZWQiLCJzaXplIiwiY2hpbGRyZW4iLCJjbGFzc05hbWUiLCJ3cmFwcGVyRWxlbWVudCIsInJlbWFpbmluZ1Byb3BzIiwiYnV0dG9uUHJvcHMiLCJzaXplQ2xhc3NuYW1lIiwiYnV0dG9uVHlwZUNsYXNzbmFtZSIsInRpdGxlVG9vbFRpcCIsInRpdGxlIiwibmV3Q2xhc3NOYW1lIiwiV3JhcHBlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQWNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7Ozs7O0FBeUJPLE1BQU1BLFdBQVcsR0FBR0MsTUFBTSxDQUFDQyxNQUFQLENBQWM7QUFDdkNDLEVBQUFBLFdBQVcsRUFBRSxhQUQwQjtBQUV2Q0MsRUFBQUEsS0FBSyxFQUFFLE9BRmdDO0FBR3ZDQyxFQUFBQSxLQUFLLEVBQUU7QUFIZ0MsQ0FBZCxDQUFwQjs7QUFNQSxNQUFNQyxXQUFXLEdBQUdMLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjO0FBQ3ZDSyxFQUFB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WSxHQUFHbkIsT0FBTyxJQUFJRixRQUFYLEdBQXNCRSxPQUFPLENBQUNvQixLQUE5QixHQUFzQyxJQUEzRDtBQUNBLFVBQU1DLFlBQVksR0FBRyx5QkFBV1IsU0FBWCxFQUFzQixLQUF0QixFQUE2QjtBQUNoRCxPQUFFLGFBQVksMkJBQWNMLElBQWQsQ0FBb0IsRUFBbEMsR0FBc0NBLElBQUksSUFBSSxJQURFO0FBRWhELE9BQUNTLGFBQUQsR0FBaUJOLElBQUksSUFBSSxJQUZ1QjtBQUdoREQsTUFBQUEsUUFIZ0Q7QUFJaEQsT0FBQ1EsbUJBQUQsR0FBdUJULFVBQVUsSUFBSTtBQUpXLEtBQTdCLENBQXJCO0FBTUEsVUFBTWEsT0FBTyxHQUFHUixjQUFjLElBQUksSUFBbEIsR0FBeUIsUUFBekIsR0FBb0NBLGNBQXBEO0FBQ0Esd0JBQ0Usb0JBQUMsT0FBRDtBQUNFLE1BQUEsU0FBUyxFQUFFTyxZQURiLENBRUU7QUFGRjtBQUdFLE1BQUEsR0FBRyxFQUFFLEtBQUt6QixZQUhaO0FBSUUsTUFBQSxRQUFRLEVBQUVFO0FBSlosT0FLTWtCLFdBTE47QUFNRSxNQUFBLEtBQUssRUFBRUc7QUFOVCxRQU9HUCxRQVBILENBREY7QUFXRDs7QUEzRWdEIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxyXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKlxyXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcclxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XHJcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxyXG4gKlxyXG4gKiBAZmxvd1xyXG4gKiBAZm9ybWF0XHJcbiAqL1xyXG5cclxuaW1wb3J0IHR5cGUge0ljb25OYW1lfSBmcm9tICcuL0ljb24nO1xyXG5cclxuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XHJcbmltcG9ydCB7bWF5YmVUb1N0cmluZ30gZnJvbSAnQGF0b20taWRlLWNvbW11bml0eS9udWNsaWRlLWNvbW1vbnMvc3RyaW5nJztcclxuaW1wb3J0IHtvbWl0fSBmcm9tICdsb2Rhc2gnO1xyXG5pbXBvcnQgYWRkVG9vbHRpcCBmcm9tICcuL2FkZFRvb2x0aXAnO1xyXG5cclxuZXhwb3J0IHR5cGUgQnV0dG9uVHlwZSA9ICdQUklNQVJZJyB8ICdJTkZPJyB8ICdTVUNDRVNTJyB8ICdXQVJOSU5HJyB8ICdFUlJPUic7XHJcbmV4cG9ydCB0eXBlIEJ1dHRvblNpemUgPSAnRVhUUkFfU01BTEwnIHwgJ1NNQUxMJyB8ICdMQVJHRSc7XHJcbnR5cGUgQnV0dG9uTm9kZU5hbWUgPSAnYnV0dG9uJyB8ICdhJztcclxuXHJcbnR5cGUgUHJvcHMgPSB7XHJcbiAgLy8gSWNvbiBuYW1lLCB3aXRob3V0IHRoZSBgaWNvbi1gIHByZWZpeC4gRS5nLiBgJ2Fycm93LXVwJ2BcclxuICBpY29uPzogSWNvbk5hbWUsXHJcbiAgLy8gT3B0aW9uYWwgc3BlY2lmaWVyIGZvciBzcGVjaWFsIGJ1dHRvbnMsIGUuZy4gcHJpbWFyeSwgaW5mbywgc3VjY2VzcyBvciBlcnJvciBidXR0b25zLlxyXG4gIGJ1dHRvblR5cGU/OiA/QnV0dG9uVHlwZSxcclxuICAvLyBBIGxvdCBsaWtlIGEgcmVmLCBob3dldmVyIHdlIG9ubHkgYWNjZXB0IHRoZSBjYWxsYmFjayBmb3JtIHNvIHdlIGNhblxyXG4gIC8vIGNvbXBvc2UgaXQgd2l0aCB0b29sdGlwcywgd2hpY2ggYXJlIGltcGxlbWVudGVkIHVzaW5nIHJlZnNcclxuICBvbkJ1dHRvbkRPTU5vZGVDaGFuZ2U/OiAoP0hUTUxCdXR0b25FbGVtZW50KSA9PiBtaXhlZCxcclxuICBzZWxlY3RlZD86IGJvb2xlYW4sXHJcbiAgc2l6ZT86IEJ1dHRvblNpemUsXHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nLFxyXG4gIC8vIFRoZSBidXR0b24ncyBjb250ZW50OyBnZW5lcmFsbHkgYSBzdHJpbmcuXHJcbiAgY2hpbGRyZW4/OiBtaXhlZCxcclxuICAvLyBBbGxvd3Mgc3BlY2lmeWluZyBhbiBlbGVtZW50IG90aGVyIHRoYW4gYGJ1dHRvbmAgdG8gYmUgdXNlZCBhcyB0aGUgd3JhcHBlciBub2RlLlxyXG4gIHdyYXBwZXJFbGVtZW50PzogQnV0dG9uTm9kZU5hbWUsXHJcbiAgdG9vbHRpcD86IGF0b20kVG9vbHRpcHNBZGRPcHRpb25zLFxyXG4gIGRpc2FibGVkPzogYm9vbGVhbixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBCdXR0b25TaXplcyA9IE9iamVjdC5mcmVlemUoe1xyXG4gIEVYVFJBX1NNQUxMOiAnRVhUUkFfU01BTEwnLFxyXG4gIFNNQUxMOiAnU01BTEwnLFxyXG4gIExBUkdFOiAnTEFSR0UnLFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCBCdXR0b25UeXBlcyA9IE9iamVjdC5mcmVlemUoe1xyXG4gIFBSSU1BUlk6ICdQUklNQVJZJyxcclxuICBJTkZPOiAnSU5GTycsXHJcbiAgU1VDQ0VTUzogJ1NVQ0NFU1MnLFxyXG4gIFdBUk5JTkc6ICdXQVJOSU5HJyxcclxuICBFUlJPUjogJ0VSUk9SJyxcclxufSk7XHJcblxyXG5jb25zdCBCdXR0b25TaXplQ2xhc3NuYW1lcyA9IE9iamVjdC5mcmVlemUoe1xyXG4gIEVYVFJBX1NNQUxMOiAnYnRuLXhzJyxcclxuICBTTUFMTDogJ2J0bi1zbScsXHJcbiAgTEFSR0U6ICdidG4tbGcnLFxyXG59KTtcclxuXHJcbmNvbnN0IEJ1dHRvblR5cGVDbGFzc25hbWVzID0gT2JqZWN0LmZyZWV6ZSh7XHJcbiAgUFJJTUFSWTogJ2J0bi1wcmltYXJ5JyxcclxuICBJTkZPOiAnYnRuLWluZm8nLFxyXG4gIFNVQ0NFU1M6ICdidG4tc3VjY2VzcycsXHJcbiAgV0FSTklORzogJ2J0bi13YXJuaW5nJyxcclxuICBFUlJPUjogJ2J0bi1lcnJvcicsXHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEdlbmVyaWMgQnV0dG9uIHdyYXBwZXIuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQnV0dG9uIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgX2J1dHRvbjogP0hUTUxCdXR0b25FbGVtZW50O1xyXG4gIF9yZW1vdmVUb29sdGlwOiA/KCkgPT4gdm9pZDtcclxuXHJcbiAgZm9jdXMoKTogdm9pZCB7XHJcbiAgICBjb25zdCBub2RlID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcyk7XHJcbiAgICBpZiAobm9kZSA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIC8vICRGbG93Rml4TWVcclxuICAgIG5vZGUuZm9jdXMoKTtcclxuICB9XHJcblxyXG4gIF9vblJlZkNoYW5nZSA9IChidXR0b246ID9IVE1MQnV0dG9uRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3Qge2Rpc2FibGVkLCBvbkJ1dHRvbkRPTU5vZGVDaGFuZ2UsIHRvb2x0aXB9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICB0aGlzLl9idXR0b24gPSBidXR0b247XHJcbiAgICBpZiAob25CdXR0b25ET01Ob2RlQ2hhbmdlKSB7XHJcbiAgICAgIG9uQnV0dG9uRE9NTm9kZUNoYW5nZSh0aGlzLl9idXR0b24pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFdoZW4gdGhlIGVsZW1lbnQgZ29lcyBhd2F5IChlLmcuIG9uIHVubW91bnQpLCByZW1vdmUgdGhlIHRvb2x0aXAuXHJcbiAgICBpZiAoYnV0dG9uID09IG51bGwgJiYgdGhpcy5fcmVtb3ZlVG9vbHRpcCAhPSBudWxsKSB7XHJcbiAgICAgIHRoaXMuX3JlbW92ZVRvb2x0aXAoKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWRpc2FibGVkICYmIHRvb2x0aXAgJiYgYnV0dG9uICE9IG51bGwpIHtcclxuICAgICAgY29uc3QgdXBkYXRlVG9vbHRpcCA9IGFkZFRvb2x0aXAodG9vbHRpcCk7XHJcbiAgICAgIHVwZGF0ZVRvb2x0aXAoYnV0dG9uKTtcclxuICAgICAgdGhpcy5fcmVtb3ZlVG9vbHRpcCA9ICgpID0+IHtcclxuICAgICAgICB1cGRhdGVUb29sdGlwKG51bGwpO1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZVRvb2x0aXAgPSBudWxsO1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHJlbmRlcigpOiBSZWFjdC5Ob2RlIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgZGlzYWJsZWQsXHJcbiAgICAgIGljb24sXHJcbiAgICAgIGJ1dHRvblR5cGUsXHJcbiAgICAgIHNlbGVjdGVkLFxyXG4gICAgICBzaXplLFxyXG4gICAgICBjaGlsZHJlbixcclxuICAgICAgY2xhc3NOYW1lLFxyXG4gICAgICB3cmFwcGVyRWxlbWVudCxcclxuICAgICAgdG9vbHRpcCxcclxuICAgICAgLi4ucmVtYWluaW5nUHJvcHNcclxuICAgIH0gPSB0aGlzLnByb3BzO1xyXG5cclxuICAgIGNvbnN0IGJ1dHRvblByb3BzID0gb21pdChyZW1haW5pbmdQcm9wcywgJ29uQnV0dG9uRE9NTm9kZUNoYW5nZScpO1xyXG5cclxuICAgIGNvbnN0IHNpemVDbGFzc25hbWUgPSBzaXplID09IG51bGwgPyAnJyA6IEJ1dHRvblNpemVDbGFzc25hbWVzW3NpemVdIHx8ICcnO1xyXG4gICAgY29uc3QgYnV0dG9uVHlwZUNsYXNzbmFtZSA9XHJcbiAgICAgIGJ1dHRvblR5cGUgPT0gbnVsbCA/ICcnIDogQnV0dG9uVHlwZUNsYXNzbmFtZXNbYnV0dG9uVHlwZV0gfHwgJyc7XHJcblxyXG4gICAgY29uc3QgdGl0bGVUb29sVGlwID0gdG9vbHRpcCAmJiBkaXNhYmxlZCA/IHRvb2x0aXAudGl0bGUgOiBudWxsO1xyXG4gICAgY29uc3QgbmV3Q2xhc3NOYW1lID0gY2xhc3NuYW1lcyhjbGFzc05hbWUsICdidG4nLCB7XHJcbiAgICAgIFtgaWNvbiBpY29uLSR7bWF5YmVUb1N0cmluZyhpY29uKX1gXTogaWNvbiAhPSBudWxsLFxyXG4gICAgICBbc2l6ZUNsYXNzbmFtZV06IHNpemUgIT0gbnVsbCxcclxuICAgICAgc2VsZWN0ZWQsXHJcbiAgICAgIFtidXR0b25UeXBlQ2xhc3NuYW1lXTogYnV0dG9uVHlwZSAhPSBudWxsLFxyXG4gICAgfSk7XHJcbiAgICBjb25zdCBXcmFwcGVyID0gd3JhcHBlckVsZW1lbnQgPT0gbnVsbCA/ICdidXR0b24nIDogd3JhcHBlckVsZW1lbnQ7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8V3JhcHBlclxyXG4gICAgICAgIGNsYXNzTmFtZT17bmV3Q2xhc3NOYW1lfVxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBudWNsaWRlLWludGVybmFsL2pzeC1zaW1wbGUtY2FsbGJhY2stcmVmc1xyXG4gICAgICAgIHJlZj17dGhpcy5fb25SZWZDaGFuZ2V9XHJcbiAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxyXG4gICAgICAgIHsuLi5idXR0b25Qcm9wc31cclxuICAgICAgICB0aXRsZT17dGl0bGVUb29sVGlwfT5cclxuICAgICAgICB7Y2hpbGRyZW59XHJcbiAgICAgIDwvV3JhcHBlcj5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiJdfQ==