"use strict";
'use babel';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _fileIcons = _interopRequireDefault(require("./file-icons"));

var _path = _interopRequireDefault(require("path"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class MRUItemView {
  initialize(listView, item) {
    this.listView = listView;
    this.item = item;
    this.element = document.createElement('li');
    this.element.itemViewData = this;
    this.element.classList.add('two-lines');
    let itemPath = null;

    if (item.getPath && typeof item.getPath === 'function') {
      itemPath = item.getPath();
    }

    const repo = MRUItemView.repositoryForPath(itemPath);

    if (repo != null) {
      const statusIconDiv = document.createElement('div');
      const status = repo.getCachedPathStatus(itemPath);

      if (repo.isStatusNew(status)) {
        statusIconDiv.className = 'status status-added icon icon-diff-added';
        this.element.appendChild(statusIconDiv);
      } else if (repo.isStatusModified(status)) {
        statusIconDiv.className = 'status status-modified icon icon-diff-modified';
        this.element.appendChild(statusIconDiv);
      }
    }

    const firstLineDiv = this.element.appendChild(document.createElement('div'));
    firstLineDiv.classList.add('primary-line', 'file');

    if (typeof item.getIconName === 'function') {
      if (atom.config.get('tabs.showIcons')) firstLineDiv.classList.add('icon', 'icon-' + item.getIconName());
    } else {
      let typeClasses = _fileIcons.default.getService().iconClassForPath(itemPath, 'tabs-mru-switcher');

      if (typeClasses) {
        if (!Array.isArray(typeClasses)) typeClasses = typeClasses.split(/\s+/g);
        if (typeClasses) firstLineDiv.classList.add('icon', ...typeClasses);
      }
    }

    firstLineDiv.setAttribute('data-name', item.getTitle());
    firstLineDiv.innerText = item.getTitle();

    if (itemPath) {
      firstLineDiv.setAttribute('data-path', itemPath);
      const secondLineDiv = this.element.appendChild(document.createElement('div'));
      secondLineDiv.classList.add('secondary-line', 'path', 'no-icon');
      secondLineDiv.innerText = itemPath;
    }
  }

  select() {
    this.element.classList.add('selected');
  }

  unselect() {
    this.element.classList.remove('selected');
  }

  static repositoryForPath(filePath) {
    if (filePath) {
      const projectPaths = atom.project.getPaths();

      for (let i = 0; i < projectPaths.length; i++) {
        if (filePath === projectPaths[i] || filePath.startsWith(projectPaths[i] + _path.default.sep)) {
          return atom.project.getRepositories()[i];
        }
      }
    }

    return null;
  }

}

exports.default = MRUItemView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL1ZlbmRvckxpYi9hdG9tLXRhYnMvbGliL21ydS1pdGVtLXZpZXcuanMiXSwibmFtZXMiOlsiTVJVSXRlbVZpZXciLCJpbml0aWFsaXplIiwibGlzdFZpZXciLCJpdGVtIiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIml0ZW1WaWV3RGF0YSIsImNsYXNzTGlzdCIsImFkZCIsIml0ZW1QYXRoIiwiZ2V0UGF0aCIsInJlcG8iLCJyZXBvc2l0b3J5Rm9yUGF0aCIsInN0YXR1c0ljb25EaXYiLCJzdGF0dXMiLCJnZXRDYWNoZWRQYXRoU3RhdHVzIiwiaXNTdGF0dXNOZXciLCJjbGFzc05hbWUiLCJhcHBlbmRDaGlsZCIsImlzU3RhdHVzTW9kaWZpZWQiLCJmaXJzdExpbmVEaXYiLCJnZXRJY29uTmFtZSIsImF0b20iLCJjb25maWciLCJnZXQiLCJ0eXBlQ2xhc3NlcyIsIkZpbGVJY29ucyIsImdldFNlcnZpY2UiLCJpY29uQ2xhc3NGb3JQYXRoIiwiQXJyYXkiLCJpc0FycmF5Iiwic3BsaXQiLCJzZXRBdHRyaWJ1dGUiLCJnZXRUaXRsZSIsImlubmVyVGV4dCIsInNlY29uZExpbmVEaXYiLCJzZWxlY3QiLCJ1bnNlbGVjdCIsInJlbW92ZSIsImZpbGVQYXRoIiwicHJvamVjdFBhdGhzIiwicHJvamVjdCIsImdldFBhdGhzIiwiaSIsImxlbmd0aCIsInN0YXJ0c1dpdGgiLCJwYXRoIiwic2VwIiwiZ2V0UmVwb3NpdG9yaWVzIl0sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7QUFFQTs7QUFDQTs7OztBQUVlLE1BQU1BLFdBQU4sQ0FBa0I7QUFDL0JDLEVBQUFBLFVBQVUsQ0FBRUMsUUFBRixFQUFZQyxJQUFaLEVBQWtCO0FBQzFCLFNBQUtELFFBQUwsR0FBZ0JBLFFBQWhCO0FBQ0EsU0FBS0MsSUFBTCxHQUFZQSxJQUFaO0FBRUEsU0FBS0MsT0FBTCxHQUFlQyxRQUFR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LFNBQXREO0FBQ0EyQixNQUFBQSxhQUFhLENBQUNELFNBQWQsR0FBMEJ6QixRQUExQjtBQUNEO0FBQ0Y7O0FBRUQyQixFQUFBQSxNQUFNLEdBQUk7QUFDUixTQUFLakMsT0FBTCxDQUFhSSxTQUFiLENBQXVCQyxHQUF2QixDQUEyQixVQUEzQjtBQUNEOztBQUVENkIsRUFBQUEsUUFBUSxHQUFJO0FBQ1YsU0FBS2xDLE9BQUwsQ0FBYUksU0FBYixDQUF1QitCLE1BQXZCLENBQThCLFVBQTlCO0FBQ0Q7O0FBRUQsU0FBTzFCLGlCQUFQLENBQTBCMkIsUUFBMUIsRUFBb0M7QUFDbEMsUUFBSUEsUUFBSixFQUFjO0FBQ1osWUFBTUMsWUFBWSxHQUFHbEIsSUFBSSxDQUFDbUIsT0FBTCxDQUFhQyxRQUFiLEVBQXJCOztBQUNBLFdBQUssSUFBSUMsQ0FBQyxHQUFHLENBQWIsRUFBZ0JBLENBQUMsR0FBR0gsWUFBWSxDQUFDSSxNQUFqQyxFQUF5Q0QsQ0FBQyxFQUExQyxFQUE4QztBQUM1QyxZQUFJSixRQUFRLEtBQUtDLFlBQVksQ0FBQ0csQ0FBRCxDQUF6QixJQUFnQ0osUUFBUSxDQUFDTSxVQUFULENBQW9CTCxZQUFZLENBQUNHLENBQUQsQ0FBWixHQUFrQkcsY0FBS0MsR0FBM0MsQ0FBcEMsRUFBcUY7QUFDbkYsaUJBQU96QixJQUFJLENBQUNtQixPQUFMLENBQWFPLGVBQWIsR0FBK0JMLENBQS9CLENBQVA7QUFDRDtBQUNGO0FBQ0Y7O0FBQ0QsV0FBTyxJQUFQO0FBQ0Q7O0FBbkU4QiIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnXHJcblxyXG5pbXBvcnQgRmlsZUljb25zIGZyb20gJy4vZmlsZS1pY29ucydcclxuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1SVUl0ZW1WaWV3IHtcclxuICBpbml0aWFsaXplIChsaXN0VmlldywgaXRlbSkge1xyXG4gICAgdGhpcy5saXN0VmlldyA9IGxpc3RWaWV3XHJcbiAgICB0aGlzLml0ZW0gPSBpdGVtXHJcblxyXG4gICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKVxyXG4gICAgdGhpcy5lbGVtZW50Lml0ZW1WaWV3RGF0YSA9IHRoaXNcclxuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKCd0d28tbGluZXMnKVxyXG5cclxuICAgIGxldCBpdGVtUGF0aCA9IG51bGxcclxuICAgIGlmIChpdGVtLmdldFBhdGggJiYgdHlwZW9mIGl0ZW0uZ2V0UGF0aCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICBpdGVtUGF0aCA9IGl0ZW0uZ2V0UGF0aCgpXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcmVwbyA9IE1SVUl0ZW1WaWV3LnJlcG9zaXRvcnlGb3JQYXRoKGl0ZW1QYXRoKVxyXG4gICAgaWYgKHJlcG8gIT0gbnVsbCkge1xyXG4gICAgICBjb25zdCBzdGF0dXNJY29uRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcclxuICAgICAgY29uc3Qgc3RhdHVzID0gcmVwby5nZXRDYWNoZWRQYXRoU3RhdHVzKGl0ZW1QYXRoKVxyXG4gICAgICBpZiAocmVwby5pc1N0YXR1c05ldyhzdGF0dXMpKSB7XHJcbiAgICAgICAgc3RhdHVzSWNvbkRpdi5jbGFzc05hbWUgPSAnc3RhdHVzIHN0YXR1cy1hZGRlZCBpY29uIGljb24tZGlmZi1hZGRlZCdcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoc3RhdHVzSWNvbkRpdilcclxuICAgICAgfSBlbHNlIGlmIChyZXBvLmlzU3RhdHVzTW9kaWZpZWQoc3RhdHVzKSkge1xyXG4gICAgICAgIHN0YXR1c0ljb25EaXYuY2xhc3NOYW1lID0gJ3N0YXR1cyBzdGF0dXMtbW9kaWZpZWQgaWNvbiBpY29uLWRpZmYtbW9kaWZpZWQnXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHN0YXR1c0ljb25EaXYpXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmaXJzdExpbmVEaXYgPSB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykpXHJcbiAgICBmaXJzdExpbmVEaXYuY2xhc3NMaXN0LmFkZCgncHJpbWFyeS1saW5lJywgJ2ZpbGUnKVxyXG4gICAgaWYgKHR5cGVvZiBpdGVtLmdldEljb25OYW1lID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGlmIChhdG9tLmNvbmZpZy5nZXQoJ3RhYnMuc2hvd0ljb25zJykpIGZpcnN0TGluZURpdi5jbGFzc0xpc3QuYWRkKCdpY29uJywgJ2ljb24tJyArIGl0ZW0uZ2V0SWNvbk5hbWUoKSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxldCB0eXBlQ2xhc3NlcyA9IEZpbGVJY29ucy5nZXRTZXJ2aWNlKCkuaWNvbkNsYXNzRm9yUGF0aChpdGVtUGF0aCwgJ3RhYnMtbXJ1LXN3aXRjaGVyJylcclxuICAgICAgaWYgKHR5cGVDbGFzc2VzKSB7XHJcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHR5cGVDbGFzc2VzKSkgdHlwZUNsYXNzZXMgPSB0eXBlQ2xhc3Nlcy5zcGxpdCgvXFxzKy9nKVxyXG4gICAgICAgIGlmICh0eXBlQ2xhc3NlcykgZmlyc3RMaW5lRGl2LmNsYXNzTGlzdC5hZGQoJ2ljb24nLCAuLi50eXBlQ2xhc3NlcylcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZmlyc3RMaW5lRGl2LnNldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJywgaXRlbS5nZXRUaXRsZSgpKVxyXG4gICAgZmlyc3RMaW5lRGl2LmlubmVyVGV4dCA9IGl0ZW0uZ2V0VGl0bGUoKVxyXG5cclxuICAgIGlmIChpdGVtUGF0aCkge1xyXG4gICAgICBmaXJzdExpbmVEaXYuc2V0QXR0cmlidXRlKCdkYXRhLXBhdGgnLCBpdGVtUGF0aClcclxuICAgICAgY29uc3Qgc2Vjb25kTGluZURpdiA9IHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcclxuICAgICAgc2Vjb25kTGluZURpdi5jbGFzc0xpc3QuYWRkKCdzZWNvbmRhcnktbGluZScsICdwYXRoJywgJ25vLWljb24nKVxyXG4gICAgICBzZWNvbmRMaW5lRGl2LmlubmVyVGV4dCA9IGl0ZW1QYXRoXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZWxlY3QgKCkge1xyXG4gICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJylcclxuICB9XHJcblxyXG4gIHVuc2VsZWN0ICgpIHtcclxuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpXHJcbiAgfVxyXG5cclxuICBzdGF0aWMgcmVwb3NpdG9yeUZvclBhdGggKGZpbGVQYXRoKSB7XHJcbiAgICBpZiAoZmlsZVBhdGgpIHtcclxuICAgICAgY29uc3QgcHJvamVjdFBhdGhzID0gYXRvbS5wcm9qZWN0LmdldFBhdGhzKClcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9qZWN0UGF0aHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBpZiAoZmlsZVBhdGggPT09IHByb2plY3RQYXRoc1tpXSB8fCBmaWxlUGF0aC5zdGFydHNXaXRoKHByb2plY3RQYXRoc1tpXSArIHBhdGguc2VwKSkge1xyXG4gICAgICAgICAgcmV0dXJuIGF0b20ucHJvamVjdC5nZXRSZXBvc2l0b3JpZXMoKVtpXVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGxcclxuICB9XHJcbn1cclxuIl19