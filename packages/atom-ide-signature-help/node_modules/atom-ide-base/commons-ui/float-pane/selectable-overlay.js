"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.makeOverlaySelectable = makeOverlaySelectable;
exports.overlayFocusFix = overlayFocusFix;
exports.focusEditor = focusEditor;
exports.blurEditor = blurEditor;
exports.makeOverLayCopyable = makeOverLayCopyable;
exports.copyListener = copyListener;

/**
 * Makes the text selectable and copyable
 *
 * Note: you can directly add `user-select: text` (and `pointer-events: all`) in CSS for better performance
 */
function makeOverlaySelectable(editor, overlayElement, focusFix = true) {
  // allow the browser to handle selecting
  overlayElement.setAttribute("tabindex", "-1"); // make it selectable

  if (!overlayElement.style.userSelect || overlayElement.style.userSelect === "none") {
    overlayElement.style.userSelect = "text";
  }

  if (focusFix) {
    // fix overlay focus issue
    overlayFocusFix(editor, overlayElement);
  } // add copy keybindings


  overlayElement.classList.add("native-key-bindings");
}
/**
 * - Focus on the datatip once the text is selected (cursor gets disabled temporarily)
 * - Remove focus once mouse leaves
 */


function overlayFocusFix(editor, element) {
  const editorComponent = atom.views.getView(editor).getComponent();
  element.addEventListener("mousedown", () => {
    blurEditor(editorComponent);
    element.addEventListener("mouseleave", () => {
      focusEditor(editorComponent);
    });
  });
}

function focusEditor(editorComponent) {
  // @ts-ignore internal api
  editorComponent === null || editorComponent === void 0 ? void 0 : editorComponent.didFocus();
}

function blurEditor(editorComponent) {
  // @ts-ignore internal api
  editorComponent === null || editorComponent === void 0 ? void 0 : editorComponent.didBlurHiddenInput({
    relatedTarget: null
  });
}
/*
██████  ███████ ██████  ██████  ███████  ██████  █████  ████████ ███████ ██████
██   ██ ██      ██   ██ ██   ██ ██      ██      ██   ██    ██    ██      ██   ██
██   ██ █████   ██████  ██████  █████   ██      ███████    ██    █████   ██   ██
██   ██ ██      ██      ██   ██ ██      ██      ██   ██    ██    ██      ██   ██
██████  ███████ ██      ██   ██ ███████  ██████ ██   ██    ██    ███████ ██████
*/

/**
 * @deprecated Use `makeOverlaySelectable` instead.
 *
 *   Makes the overlay component copyable
 *
 *   - You should call `makeOverlaySelectable` before this
 *   - If your element already has mouseenter and mouseleav listeners, directly use `copyListener`
 */


function makeOverLayCopyable(element) {
  element.addEventListener("mouseenter", () => {
    element.addEventListener("keydown", copyListener);
  });
  element.addEventListener("mouseleave", () => {
    element.removeEventListener("keydown", copyListener);
  });
}
/**
 * @deprecated Use `makeOverlaySelectable` instead.
 *
 *   A manual copy listener Usage. Add the listener to your mouse enter and mouseleave listeners
 *
 *   ```ts
 *   element.addEventListener("mouseenter", () => {element.addEventListener("keydown", copyListener)}`
 *   element.addEventListener("mouseleave", () => {element.removeEventListener("keydown", copyListener)}`
 * ```
 */


async function copyListener(event) {
  event.preventDefault();

  if (event.ctrlKey && event.key === "c") {
    var _document$getSelectio, _document$getSelectio2;

    const text = (_document$getSelectio = (_document$getSelectio2 = document.getSelection()) === null || _document$getSelectio2 === void 0 ? void 0 : _document$getSelectio2.toString()) !== null && _document$getSelectio !== void 0 ? _document$getSelectio : "";
    await navigator.clipboard.writeText(text);
  }
} // TODO we should not need to manually listen for copy paste
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy1jb21tb25zLXVpL2Zsb2F0LXBhbmUvc2VsZWN0YWJsZS1vdmVybGF5LnRzIl0sIm5hbWVzIjpbIm1ha2VPdmVybGF5U2VsZWN0YWJsZSIsImVkaXRvciIsIm92ZXJsYXlFbGVtZW50IiwiZm9jdXNGaXgiLCJzZXRBdHRyaWJ1dGUiLCJzdHlsZSIsInVzZXJTZWxlY3QiLCJvdmVybGF5Rm9jdXNGaXgiLCJjbGFzc0xpc3QiLCJhZGQiLCJlbGVtZW50IiwiZWRpdG9yQ29tcG9uZW50IiwiYXRvbSIsInZpZXdzIiwiZ2V0VmlldyIsImdldENvbXBvbmVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJibHVyRWRpdG9yIiwiZm9jdXNFZGl0b3IiLCJkaWRGb2N1cyIsImRpZEJsdXJIaWRkZW5JbnB1dCIsInJlbGF0ZWRUYXJnZXQiLCJtYWtlT3ZlckxheUNvcHlhYmxlIiwiY29weUxpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJjdHJsS2V5Iiwia2V5IiwidGV4dCIsImRvY3VtZW50IiwiZ2V0U2VsZWN0aW9uIiwidG9TdHJpbmciLCJuYXZpZ2F0b3IiLCJjbGlwYm9hcmQiLCJ3cml0ZVRleHQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxTQUFTQSxxQkFBVCxDQUErQkMsTUFBL0IsRUFBbURDLGNBQW5ELEVBQWdGQyxRQUFRLEdBQUcsSUFBM0YsRUFBaUc7QUFDdEc7QUFDQUQsRUFBQUEsY0FBYyxDQUFDRSxZQUFmLENBQTRCLFVBQTVCLEVBQXdDLElBQXhDLEVBRnNHLENBSXRHOztBQUNBLE1BQUksQ0FBQ0YsY0FBYyxDQUFDRyxLQUFmLENBQXFCQyxVQUF0QixJQUFvQ0osY0FBYyxDQUFDRyxLQUFmLENBQXFCQyxVQUFyQixLQUFvQyxNQUE1RSxFQUFvRjtBQUNsRkosSUFBQUEsY0FBYyxDQUFDRyxLQUFmLENBQXFCQyxVQUFyQixHQUFrQyxNQUFsQztBQUNEOztBQUVELE1BQUlILFFBQUosRUFBYztBQUNaO0FBQ0FJLElBQUFBLGVBQWUsQ0FBQ04sTUFBRCxFQUFTQyxjQUFULENBQWY7QUFDRCxHQVpxRyxDQWN0Rzs7O0FBQ0FBLEVBQUFBLGNBQWMsQ0FBQ00sU0FBZixDQUF5QkMsR0FBekIsQ0FBNkIscUJBQTdCO0FBQ0Q7QUFFRDtBQUNBO0FBQ0E7QUFDQTs7O0FBQ08sU0FBU0YsZUFBVCxDQUF5Qk4sTUFBekIsRUFBNkNTLE9BQTdDLEVBQW1FO0FBQ3hFLFFBQU1DLGVBQWUsR0FBR0MsSUFBSSxDQUFDQyxLQUFMLENBQVdDLE9BQVgsQ0FBbUJiLE1BQW5CLEVBQTJCYyxZQUEzQixFQUF4QjtBQUNBTCxFQUFBQSxPQUFPLENBQUNNLGdCQUFSLENBQXlCLFdBQXpCLEVBQXNDLE1BQU07QUFDMUNDLElBQUFBLFVBQVUsQ0FBQ04sZUFBRCxDQUFWO0FBQ0FELElBQUFBLE9BQU8sQ0FBQ00sZ0JBQVIsQ0FBeUIsWUFBekIsRUFBdUMsTUFBTTtBQUMzQ0UsTUFBQUEsV0FBVyxDQUFDUCxlQUFELENBQVg7QUFDRCxLQUZEO0FBR0QsR0FMRDtBQU1EOztBQUVNLFNBQVNPLFdBQVQsQ0FBcUJQLGVBQXJCLEVBQTJEO0FBQ2hFO0FBQ0FBLEVBQUFBLGVBQWUsU0FBZixJQUFBQSxlQUFlLFdBQWYsWUFBQUEsZUFBZSxDQUFFUSxRQUFqQjtBQUNEOztBQUVNLFNBQVNGLFVBQVQsQ0FBb0JOLGVBQXBCLEVBQTBEO0FBQy9EO0FBQ0FBLEVBQUFBLGVBQWUsU0FBZixJQUFBQSxlQUFlLFdBQWYsWUFBQUEsZUFBZSxDQUFFUyxrQkFBakIsQ0FBb0M7QUFDbENDLElBQUFBLGFBQWEsRUFBRTtBQURtQixHQUFwQztBQUdEO0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ08sU0FBU0MsbUJBQVQsQ0FBNkJaLE9BQTdCLEVBQW1EO0FBQ3hEQSxFQUFBQSxPQUFPLENBQUNNLGdCQUFSLENBQXlCLFlBQXpCLEVBQXVDLE1BQU07QUFDM0NOLElBQUFBLE9BQU8sQ0FBQ00sZ0JBQVIsQ0FBeUIsU0FBekIsRUFBb0NPLFlBQXBDO0FBQ0QsR0FGRDtBQUlBYixFQUFBQSxPQUFPLENBQUNNLGdCQUFSLENBQXlCLFlBQXpCLEVBQXVDLE1BQU07QUFDM0NOLElBQUFBLE9BQU8sQ0FBQ2MsbUJBQVIsQ0FBNEIsU0FBNUIsRUFBdUNELFlBQXZDO0FBQ0QsR0FGRDtBQUdEO0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUNPLGVBQWVBLFlBQWYsQ0FBNEJFLEtBQTVCLEVBQWtEO0FBQ3ZEQSxFQUFBQSxLQUFLLENBQUNDLGNBQU47O0FBQ0EsTUFBSUQsS0FBSyxDQUFDRSxPQUFOLElBQWlCRixLQUFLLENBQUNHLEdBQU4sS0FBYyxHQUFuQyxFQUF3QztBQUFBOztBQUN0QyxVQUFNQyxJQUFJLHNEQUFHQyxRQUFRLENBQUNDLFlBQVQsRUFBSCwyREFBRyx1QkFBeUJDLFFBQXpCLEVBQUgseUVBQTBDLEVBQXBEO0FBQ0EsVUFBTUMsU0FBUyxDQUFDQyxTQUFWLENBQW9CQyxTQUFwQixDQUE4Qk4sSUFBOUIsQ0FBTjtBQUNEO0FBQ0YsQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBUZXh0RWRpdG9yLCBUZXh0RWRpdG9yQ29tcG9uZW50IH0gZnJvbSBcImF0b21cIlxuXG4vKipcbiAqIE1ha2VzIHRoZSB0ZXh0IHNlbGVjdGFibGUgYW5kIGNvcHlhYmxlXG4gKlxuICogTm90ZTogeW91IGNhbiBkaXJlY3RseSBhZGQgYHVzZXItc2VsZWN0OiB0ZXh0YCAoYW5kIGBwb2ludGVyLWV2ZW50czogYWxsYCkgaW4gQ1NTIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1ha2VPdmVybGF5U2VsZWN0YWJsZShlZGl0b3I6IFRleHRFZGl0b3IsIG92ZXJsYXlFbGVtZW50OiBIVE1MRWxlbWVudCwgZm9jdXNGaXggPSB0cnVlKSB7XG4gIC8vIGFsbG93IHRoZSBicm93c2VyIHRvIGhhbmRsZSBzZWxlY3RpbmdcbiAgb3ZlcmxheUVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgXCItMVwiKVxuXG4gIC8vIG1ha2UgaXQgc2VsZWN0YWJsZVxuICBpZiAoIW92ZXJsYXlFbGVtZW50LnN0eWxlLnVzZXJTZWxlY3QgfHwgb3ZlcmxheUVsZW1lbnQuc3R5bGUudXNlclNlbGVjdCA9PT0gXCJub25lXCIpIHtcbiAgICBvdmVybGF5RWxlbWVudC5zdHlsZS51c2VyU2VsZWN0ID0gXCJ0ZXh0XCJcbiAgfVxuXG4gIGlmIChmb2N1c0ZpeCkge1xuICAgIC8vIGZpeCBvdmVybGF5IGZvY3VzIGlzc3VlXG4gICAgb3ZlcmxheUZvY3VzRml4KGVkaXRvciwgb3ZlcmxheUVsZW1lbnQpXG4gIH1cblxuICAvLyBhZGQgY29weSBrZXliaW5kaW5nc1xuICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibmF0aXZlLWtleS1iaW5kaW5nc1wiKVxufVxuXG4vKipcbiAqIC0gRm9jdXMgb24gdGhlIGRhdGF0aXAgb25jZSB0aGUgdGV4dCBpcyBzZWxlY3RlZCAoY3Vyc29yIGdldHMgZGlzYWJsZWQgdGVtcG9yYXJpbHkpXG4gKiAtIFJlbW92ZSBmb2N1cyBvbmNlIG1vdXNlIGxlYXZlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gb3ZlcmxheUZvY3VzRml4KGVkaXRvcjogVGV4dEVkaXRvciwgZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgY29uc3QgZWRpdG9yQ29tcG9uZW50ID0gYXRvbS52aWV3cy5nZXRWaWV3KGVkaXRvcikuZ2V0Q29tcG9uZW50KClcbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsICgpID0+IHtcbiAgICBibHVyRWRpdG9yKGVkaXRvckNvbXBvbmVudClcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsICgpID0+IHtcbiAgICAgIGZvY3VzRWRpdG9yKGVkaXRvckNvbXBvbmVudClcbiAgICB9KVxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9jdXNFZGl0b3IoZWRpdG9yQ29tcG9uZW50OiBUZXh0RWRpdG9yQ29tcG9uZW50KSB7XG4gIC8vIEB0cy1pZ25vcmUgaW50ZXJuYWwgYXBpXG4gIGVkaXRvckNvbXBvbmVudD8uZGlkRm9jdXMoKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYmx1ckVkaXRvcihlZGl0b3JDb21wb25lbnQ6IFRleHRFZGl0b3JDb21wb25lbnQpIHtcbiAgLy8gQHRzLWlnbm9yZSBpbnRlcm5hbCBhcGlcbiAgZWRpdG9yQ29tcG9uZW50Py5kaWRCbHVySGlkZGVuSW5wdXQoe1xuICAgIHJlbGF0ZWRUYXJnZXQ6IG51bGwsXG4gIH0pXG59XG5cbi8qXG7ilojilojilojilojilojiloggIOKWiOKWiOKWiOKWiOKWiOKWiOKWiCDilojilojilojilojilojiloggIOKWiOKWiOKWiOKWiOKWiOKWiCAg4paI4paI4paI4paI4paI4paI4paIICDilojilojilojilojilojiloggIOKWiOKWiOKWiOKWiOKWiCAg4paI4paI4paI4paI4paI4paI4paI4paIIOKWiOKWiOKWiOKWiOKWiOKWiOKWiCDilojilojilojilojilojilohcbuKWiOKWiCAgIOKWiOKWiCDilojiloggICAgICDilojiloggICDilojilogg4paI4paIICAg4paI4paIIOKWiOKWiCAgICAgIOKWiOKWiCAgICAgIOKWiOKWiCAgIOKWiOKWiCAgICDilojiloggICAg4paI4paIICAgICAg4paI4paIICAg4paI4paIXG7ilojiloggICDilojilogg4paI4paI4paI4paI4paIICAg4paI4paI4paI4paI4paI4paIICDilojilojilojilojilojiloggIOKWiOKWiOKWiOKWiOKWiCAgIOKWiOKWiCAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiCAgICDilojiloggICAg4paI4paI4paI4paI4paIICAg4paI4paIICAg4paI4paIXG7ilojiloggICDilojilogg4paI4paIICAgICAg4paI4paIICAgICAg4paI4paIICAg4paI4paIIOKWiOKWiCAgICAgIOKWiOKWiCAgICAgIOKWiOKWiCAgIOKWiOKWiCAgICDilojiloggICAg4paI4paIICAgICAg4paI4paIICAg4paI4paIXG7ilojilojilojilojilojiloggIOKWiOKWiOKWiOKWiOKWiOKWiOKWiCDilojiloggICAgICDilojiloggICDilojilogg4paI4paI4paI4paI4paI4paI4paIICDilojilojilojilojilojilogg4paI4paIICAg4paI4paIICAgIOKWiOKWiCAgICDilojilojilojilojilojilojilogg4paI4paI4paI4paI4paI4paIXG4qL1xuXG4vKipcbiAqIEBkZXByZWNhdGVkIFVzZSBgbWFrZU92ZXJsYXlTZWxlY3RhYmxlYCBpbnN0ZWFkLlxuICpcbiAqICAgTWFrZXMgdGhlIG92ZXJsYXkgY29tcG9uZW50IGNvcHlhYmxlXG4gKlxuICogICAtIFlvdSBzaG91bGQgY2FsbCBgbWFrZU92ZXJsYXlTZWxlY3RhYmxlYCBiZWZvcmUgdGhpc1xuICogICAtIElmIHlvdXIgZWxlbWVudCBhbHJlYWR5IGhhcyBtb3VzZWVudGVyIGFuZCBtb3VzZWxlYXYgbGlzdGVuZXJzLCBkaXJlY3RseSB1c2UgYGNvcHlMaXN0ZW5lcmBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1ha2VPdmVyTGF5Q29weWFibGUoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoKSA9PiB7XG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjb3B5TGlzdGVuZXIpXG4gIH0pXG5cbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCAoKSA9PiB7XG4gICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjb3B5TGlzdGVuZXIpXG4gIH0pXG59XG5cbi8qKlxuICogQGRlcHJlY2F0ZWQgVXNlIGBtYWtlT3ZlcmxheVNlbGVjdGFibGVgIGluc3RlYWQuXG4gKlxuICogICBBIG1hbnVhbCBjb3B5IGxpc3RlbmVyIFVzYWdlLiBBZGQgdGhlIGxpc3RlbmVyIHRvIHlvdXIgbW91c2UgZW50ZXIgYW5kIG1vdXNlbGVhdmUgbGlzdGVuZXJzXG4gKlxuICogICBgYGB0c1xuICogICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsICgpID0+IHtlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNvcHlMaXN0ZW5lcil9YFxuICogICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsICgpID0+IHtlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNvcHlMaXN0ZW5lcil9YFxuICogYGBgXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb3B5TGlzdGVuZXIoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICBpZiAoZXZlbnQuY3RybEtleSAmJiBldmVudC5rZXkgPT09IFwiY1wiKSB7XG4gICAgY29uc3QgdGV4dCA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpPy50b1N0cmluZygpID8/IFwiXCJcbiAgICBhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0ZXh0KVxuICB9XG59IC8vIFRPRE8gd2Ugc2hvdWxkIG5vdCBuZWVkIHRvIG1hbnVhbGx5IGxpc3RlbiBmb3IgY29weSBwYXN0ZVxuIl19